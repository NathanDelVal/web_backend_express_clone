<!DOCTYPE html>
<html lang="pt-br">


<!--HEADER-->

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="../images/icon/apple-icon-mezzomo.png">
    <link rel="icon" type="image/png" href="../images/icon/favicon_mezzomo3.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>
        Robotax: Documentos
    </title>
    <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css"
        href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="../assets/css/material-dashboard.min.css?v=2.1.2" rel="stylesheet" />
    <!--local CSS -->
    <link rel="stylesheet" type="text/css" href="../local/style_docGED.css">

    <script src="../assets/js/core/jquery-3.5.1.js"></script>

</head>


<body>

    <div class="wrapper">
		<!-- SIDEBAR -->
        <div class="sidebar" data-color="yellow" data-background-color="black"
            data-image="../assets/img/contabeisbw.jpg">
            <!--Tip 1: You can change the color of the sidebar using: data-color="purple | azure | green | orange | danger" Tip 2: you can also add an image using data-image tag -->
            <div class="sidebar-wrapper">
                <ul class="nav">
                    <!--CARD NO SIDE BAR - LOGO DO USÚARIO E NOME -->
                    {{> escritorio/navbar_ged}}
                </ul>
            </div>
        </div>

        <div class="main-panel">
            <nav class="navbar navbar-expand-lg navbar-transparent">
                <div class="container-fluid">
                    <div class="row justify-content-end">
                        <div class="navbar-minimize">
							<button id="minimizeSidebar" class="btn btn-just-icon btn-white btn-fab btn-round">
								<i class="material-icons text_align-center visible-on-sidebar-regular">more_vert</i>
								<i class="material-icons design_bullet-list-67 visible-on-sidebar-mini">view_list</i>
							</button>
						</div>
                        <a class="navbar-brand" href="/ged/AdminGED">Controle de Obrigações</a>
                    </div>
                    <ul class="navbar-nav">
                        <li class="nav-item ">
                            <a style="font-weight: 600!important;" href="/menu/apps" class="nav-link nav-link-back">
                                <i class="material-icons">undo</i> Voltar
                            </a>
                        </li>
                        {{> escritorio/help_btn}}
                    </ul>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="navbar-toggler-icon icon-bar"></span>
                        <span class="navbar-toggler-icon icon-bar"></span>
                        <span class="navbar-toggler-icon icon-bar"></span>
                    </button>
                </div>
            </nav>

            <div class="container-fluid padding-lr">
                <div class="row align-items-center"><!--
                    <div class="col-lg-12 header-robo" style="z-index: 2;">
                        <h2>Controle de Obrigações</h2>
                    </div>-->
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header card-header-info2">
                                <h4 class="card-title">Controle de Documentos</h4>
                            </div>
                            <div class="card-body">
                                <div class="col-sm-12 col-md-12 col-lg-12 mb-4">
                                    <div class="row align-items-center">
                                        <div class="col-lg-12 text-center">
                                            <h3 style="font-weight: bold;">Filtros</h3>
                                        </div>

                                        <!--
                                        <div class="col-sm-12 col-md-6 col-lg-4 mb-4">
                                            <div class="form-group has-default">
                                                <div class="input-group">
                                                    <label>
                                                        <h6 style="font-weight: bold;">
                                                            Cliente</h6>
                                                    </label>
                                                    <select name="gedmg_cliente" id="gedmg_cliente" title='Selecionar Cliente' class="custom-select form-control selectpicker" data-style="btn-2 btn-link" type="text" oninput="this.className=''">
                                                        <option value="dinamico">
                                                            Inserir Clientes dinamicamente
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        -->

                                        <div class="col-sm-12 col-md-6 col-lg-4 mb-4">
                                            <!--<h5>Manifestação</h5>-->
                                            <div class="form-group has-default">
                                                <div class="input-group ">
                                                    <label>
                                                        <h6 style="font-weight: bold;">
                                                            Regime</h6>
                                                    </label>
                                                    <select name="gedmg_regime" id="gedmg_regime" title='Selecionar Regime'
                                                        class="custom-select form-control selectpicker"
                                                        data-style="btn-2 btn-link" type="text" oninput="this.className=''">
                                                        <option value="">Selecionar Regime</option>
                                                        <option value="Simples-Nacional">Simples Nacional</option>
                                                        <option value="Lucro Presumido">
                                                            Lucro Presumido </option>
                                                        <option value="Lucro Real">
                                                            Lucro Real </option>
                                                        <option value="Mei">
                                                            CEI </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-12 col-md-6 col-lg-4 mb-4">
                                            <div class="form-group has-default">
                                                <div class="input-group ">
                                                    <label>
                                                        <h6 style="font-weight: bold;">
                                                            Status</h6>
                                                    </label>
                                                    <select name="gedmg_status" id="gedmg_status" title='Selecionar Status'
                                                        class="custom-select form-control selectpicker" data-style="btn-2 btn-link" type="text" oninput="this.className=''">
                                                        <option value="">Selecionar Status</option>
                                                        <option value="Pendente">Pendente</option>
                                                        <option value="Enviado">Enviado</option>
                                                        <option value="Pago">Pago</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-12 col-md-6 col-lg-4">
                                            <label>
                                                <h6 style="font-weight: bold;">
                                                    Mês</h6>
                                            </label>
                                            <div class="input-group form-group input-card-border p-0 m-0">
                                                <input name="gedmg_data_referencia" id="datepickerGed" type="text" class="form-control p-2
                monthPicker" placeholder="Selecionar Mês" autocomplete="off" value="">
                                                <span class="input-group-addon group-addon">
                                                    <i class="material-icons">today</i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="filter_area_btn_buscar" class="text-right mb-4">
                                    <button id="btn_ged_filtrar" class="btn btn-black btn-sm">
                                        Filtrar
                                    </button>
                                </div>

                                <div id="div_table" class="table-responsive box drag hideElement">
                                    <table id="table_manage" class="table display table-striped table-no-bordered table-hover"
                                        cellspacing="0">
                                        <thead>
                                            <tr class="table-header">
                                                <th
                                                    style="background-color: #edcd00!important; color: #000!important; min-width: 420px!important;">
                                                    Cliente
                                                </th>
                                                <th>CFEM</th>
                                                <th>C. Confederativa</th>
                                                <th>DAE</th>
                                                <th>DAM</th>
                                                <th>DARF</th>
                                                <th>DAS</th>
                                                <th>FUNRURAL</th>
                                                <th>GNRE</th>
                                                <th>HONORARIO</th>
                                                <th>INSS</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {{> escritorio/footer_internal}}
        </div>
    </div>


    <!--FOOTER-->
    

    <!--Correção do Violation Scroll non-passive event-->
    <script src=" ../local/plugins/fix-non-passive.js"></script>
    <!--   Core JS Files   -->
    <script src="../assets/js/core/popper.min.js"></script>
    <script src="../assets/js/core/bootstrap-material-design.js"></script>
    <script src="../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
    <!-- Plugin for the momentJs  -->
    <script src="../assets/js/plugins/moment.min.js"></script>
    <!-- Plugin for the momentJs TRADUÇÕES LOCAIS  -->
    <script src="../assets/js/plugins/moment-with-locales.js"></script>
    <!--  Plugin for Sweet Alert -->
    <script src="../assets/js/plugins/sweetalert2.js"></script>
    <!-- Forms Validations Plugin -->
    <script src="../assets/js/plugins/jquery.validate.min.js"></script>
    <!-- Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
    <script src="../assets/js/plugins/jquery.bootstrap-wizard.js"></script>
    <!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
    <script src="../assets/js/plugins/bootstrap-selectpicker.js"></script>
    <!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
    <script src="../assets/js/plugins/bootstrap-datetimepicker.min.js"></script>
    <!--  DataTables.net Plugin, full documentation here: https://datatables.net/  -->
    <script src="../assets/js/plugins/jquery.dataTables.min.js"></script>
    <!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
    <script src="../assets/js/plugins/bootstrap-tagsinput.js"></script>
    <!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
    <script src="../assets/js/plugins/jasny-bootstrap.min.js"></script>
    <!--  Full Calendar Plugin, full documentation here: https://github.com/fullcalendar/fullcalendar    -->
    <script src="../assets/js/plugins/fullcalendar.min.js"></script>
    <!-- Vector Map plugin, full documentation here: http://jvectormap.com/documentation/ -->
    <script src="../assets/js/plugins/jquery-jvectormap.js"></script>
    <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
    <script src="../assets/js/plugins/nouislider.min.js"></script>
    <!-- Include a polyfill for ES6 Promises (optional) for IE11, UC Browser and Android browser support SweetAlert -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script>
    <!-- Library for adding dinamically elements -->
    <script src="../assets/js/plugins/arrive.min.js"></script>
    <!-- Chartist JS -->
    <script src="../assets/js/plugins/chartist.min.js"></script>
    <!--  Notifications Plugin    -->
    <script src="../assets/js/plugins/bootstrap-notify.js"></script>
    <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="../assets/js/material-dashboard.min.js?v=2.1.2" type="text/javascript"></script>
    <!-- Material Dashboard DEMO methods, don't include it in your project!
         <script src="../assets/demo/demo.js"></script>-->
    <!--DRAG MOUSE-->
    <script src="../local/plugins/drag/drag.js"></script>
    <!-- AJAX JQUERY POST UPDATE update_form_pendente MODAL -->
    <script src="../local/metodos/post/update_modal_alterar_regras.js"></script>

    <!--SWEET ALERT-->
    <!--LOCAL-->
    <script src="../local/plugins/sweetalert/js/sweetalert2.min.js"></script>
    <link rel="stylesheet" href="../local/plugins/sweetalert/css/sweetalert2.min.css" id="theme-styles">


    <!--MASK FOR FORMS-->
    <script src="../local/plugins/mask_input/jquery.maskedinput.js" type="text/javascript"></script>

    <!-- HANDLE SELECT BoxeS ON TABLE
    <script src="../assets/js/plugins/datatables_select_rows.js"></script> -->

    <!--    Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
    <script src="../../assets/js/plugins/bootstrap-tagsinput.js"></script>

    <script src="../local/page_document_ready/script_notas_fiscais.js" type="text/javascript"></script>

    {{> escritorio/modal_chamados}}

    <script type="text/javascript">
        $(document).ready(function () {
            //ACTIVE NAV-ITEM
            var navs = document.getElementsByClassName('nav-item');
            for (var x = 0; x < navs.length; x++) {
                if (navs[x].childNodes[1].attributes[1].nodeValue == location.pathname) {
                    var nav = navs[x]
                    $(nav).addClass('active')
                }
            }
        });
    </script>

    <script>
        $('#myModal').on('shown.bs.modal', function () {
            $('#myInput').trigger('focus')
        })
    </script>


    <script>
        var dadosTabelaGED = []
        var tabelaNotasFiscais;

        GED_obrigacoes = async () => {

            var dados = {}
            dados.gedmg_cliente = $('#gedmg_cliente').val()
            dados.gedmg_regime = $('#gedmg_regime').val()
            dados.gedmg_status = $('#gedmg_status').val()
            dados.gedmg_data_referencia = $('#datepickerGed').val()

            if (dados.gedmg_cliente) {
                dados.gedmg_cliente = dados.gedmg_cliente.trim()
            }
            if (dados.gedmg_regime) {
                dados.gedmg_regime = dados.gedmg_regime.trim()
            }
            if (dados.gedmg_status) {
                dados.gedmg_status = dados.gedmg_status.trim()
            }
            if (dados.gedmg_data_referencia) {
                dados.gedmg_data_referencia = dados.gedmg_data_referencia.trim()
            }

            $.ajax({
                url: '/ged/tabela-controle',
                type: 'post',
                data: dados
            }).done(function (response) {

                //console.log('response:', response)

                if (response.length > 0) {

                    dadosTabelaGED = JSON.parse(response)


                    if (dadosTabelaGED.length > 0) {
                        $("#div_table").removeClass('hideElement')

                        tabelaNotasFiscais = $('#table_manage').DataTable({

                            destroy: true,
                            deferRender: true,
                            data: dadosTabelaGED,
                            columns: [{
                                data: "cliente"
                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {
                                    if (full.CFEM) {
                                        return full.CFEM
                                    } else {
                                        //meta.col.header()
                                        return 'Pendente'
                                    }
                                }
                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.CONTRIB) {
                                        return full.CONTRIB
                                    } else {
                                        return 'Pendente'
                                    }
                                }
                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.DAE) {
                                        return full.DAE
                                    } else {
                                        return 'Pendente'
                                    }
                                }
                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.DAM) {
                                        return full.DAM
                                    } else {
                                        return 'Pendente'
                                    }
                                }
                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {
                                    
                                    if (full.DARF) {
                                        return full.DARF
                                    } else {
                                        return 'Pendente'
                                    }
                                }

                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.DAS) {
                                        return full.DAS
                                    } else {
                                        return 'Pendente'
                                    }
                                }

                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.FUNRURAL) {
                                        return full.FUNRURAL
                                    } else {
                                        return 'Pendente'
                                    }
                                }

                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.GNRE) {
                                        return full.GNRE
                                    } else {

                                        return 'Pendente'

                                    }
                                }

                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.HONORARIO) {
                                        return full.HONORARIO
                                    } else {


                                        return 'Pendente'
                                    }
                                }

                            }, {
                                defaultContent: "",
                                render: function (data, type, full, meta) {

                                    if (full.INSS) {
                                        return full.INSS
                                    } else {
                                        return 'Pendente'
                                    }
                                }
                            }],
                            processing: true,
                            order: [
                                [0, 'asc']
                            ],
                            fixedHeader: {
                                header: false,
                                footer: false
                            },
                            pagingType: "full_numbers",
                            lengthMenu: [
                                [50, 100, 1000, -1],
                                [50, 100, 1000, "Todos"]
                            ],
                            responsive: false,
                            language: {
                                "url": "../assets/js/plugins/dataTables.ptbr.lang",
                                search: "_INPUT_",
                                searchPlaceholder: "",
                            },
                            rowCallback: function (row, data, index) {
                                //index é a quantidde de linhas da coluna: 21

                                for (var [key, value] of Object.entries(data)) {

                                    var linha = $(row).find(`td`)
                                    //console.log("===> ",  $(linha)[2].textContent)
                                    
                                    //var textoCelula_1 = $(row).find(`td:eq(1)`).text()
                                    for (var i = 0; i < linha.length; i++) {
                                        if (linha[i].textContent.toLowerCase() == "pendente") {
                                            //$(linha[i]).addClass('pendente')
                                            $(linha[i]).append('⛔')
                        }
                                        if (linha[i].textContent.toLowerCase() == "enviado") {
                                            //$(linha[i]).addClass('enviado')
                                            $(linha[i]).append('📩')
                                        }
                                        if (linha[i].textContent.toLowerCase() == "pago") {
                                            //$(linha[i]).addClass('pago')
                                            $(linha[i]).append('✔️')
                                        }
                                    }
                                    /*
                                    if (value == 'Enviado' || value == 'ENVIADO') {
                                        $(row).find(`td:eq(4)`).addClass('enviadocontroleged')

                                    }else{
                                        $(row).find(`td:eq(4)`).addClass('pendentecontroleged')
                                    }
                                    */

                                }






                            },
                            initComplete: function (settings, json) {

                                // Enable TFOOT scoll bars
                                $('.dataTables_scrollFoot').css('overflow', 'auto');

                                $('.dataTables_scrollHead').css('overflow', 'auto');

                                // Sync TFOOT scrolling with TBODY
                                $('.dataTables_scrollFoot').on('scroll', function () {
                                    $('.dataTables_scrollBody').scrollLeft($(this).scrollLeft());
                                });

                                $('.dataTables_scrollHead').on('scroll', function () {
                                    $('.dataTables_scrollBody').scrollLeft($(this).scrollLeft());
                                });

                            }
                        });

                    } else {
                        $("#div_table").addClass('hideElement')

                    }

                }

            })
        }
        $(document).ready(function () {
            GED_obrigacoes()
        })

        $("#btn_ged_filtrar").on('click', function () {
            console.log('click')
            GED_obrigacoes()
        })

    </script>




</body>

</html>